<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>SCCM OSD Naming - i-py.com</title><link rel="icon" type="image/png" href=icons/myicon.png /><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="SCCM OSD Naming" />
<meta property="og:description" content="So I&rsquo;ve been working through the process of putting together a new Windows 8.1 image for OSD Deployment within our organization." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://i-py.com/posts/2015-08-20-sccm-osd-computer-naming/" />
<meta property="article:published_time" content="2015-08-20T12:32:30-05:00" />
<meta property="article:modified_time" content="2015-08-20T12:32:30-05:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SCCM OSD Naming"/>
<meta name="twitter:description" content="So I&rsquo;ve been working through the process of putting together a new Windows 8.1 image for OSD Deployment within our organization."/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="https://i-py.com/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://i-py.com/css/main.css" />
	<link rel="stylesheet" type="text/css" href="https://i-py.com/css/custom.css" />
	

	
	<script src="https://i-py.com/js/main.js"></script>
	<script src="https://i-py.com/js/abc.js"></script>
	<script src="https://i-py.com/js/xyz.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
</head>

<body>
	<div class="container wrapper post">
		<div class="header">
	<base href="https://i-py.com/">
	<h1 class="site-title"><a href="https://i-py.com/">i-py.com</a></h1>
	<div class="site-description"><h2>Technical Blog of Francis Setash</h2><nav class="nav social">
			<ul class="flat"></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">All posts</a>
			</li>
			
			<li>
				<a href="/tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post-header">
			<h1 class="title">SCCM OSD Naming</h1>
			<div class="meta">Posted on &mdash; Aug 20, 2015</div>
		</div>

		<div class="markdown">
			<p>So I&rsquo;ve been working through the process of putting together a new Windows 8.1 image for OSD Deployment within our organization.</p>
<p>One item that&rsquo;s always irked me a bit has been computer naming having no integration within SCCM. Either way, here&rsquo;s a quick script process to rename a PC as a part of a build process. First and foremost, we need to get a SecureString variant of the password we want to actually save somewhere; we wouldnt want it plaintext in any context. This still has some risks, but if the shares where the SCCM package is held is secured, and the account at hand has limited rights, it&rsquo;s not too bad. First off - lets get that PowerShell Secure String - do this at a command prompt - don&rsquo;t include this plaintext in the script&hellip;please:</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#2aa198">&#34;PASSWORD&#34;</span> | <span style="color:#b58900">ConvertTo-SecureString</span> -AsPlainText - Force | <span style="color:#b58900">ConvertFrom-SecureString</span> | <span style="color:#b58900">Out-File</span> <span style="color:#2aa198">&#34;C:\Temp\savedpwd.txt&#34;</span>
</code></pre></div><p>Once we have this text string we can either reference the text file in our scripts or use the contents as a part of a PowerShell Credential object:</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#586e75">#We use a serialnumber object from the Dell BIOS to insert into our PC naming convention</span>
<span style="color:#268bd2">$sn</span> = <span style="color:#b58900">gwmi </span>win32_bios | <span style="color:#b58900">Select </span>serialnumber
<span style="color:#268bd2">$NewComputerName</span> = <span style="color:#2aa198">&#34;PC-PREFIX&#34;</span> + <span style="color:#268bd2">$sn</span>.serialnumber 

<span style="color:#586e75">#Specify the user credentials</span>
<span style="color:#586e75">#Note! The password string is the text that was output in the previous command inside savedpwd.txt; I kept it inclusive here but you can also read-file the text file</span>
<span style="color:#268bd2">$user</span> = <span style="color:#2aa198">&#34;domain\account&#34;</span>
<span style="color:#268bd2">$pass</span> = <span style="color:#2aa198">&#34;01000sadfasdfasdf67f40920000000004800000a0000000100000000551ae1296831a0af8f89d2cf2fe50ac200000asdf089o372hnioujhda0f98h2lkjshodc0f89234r9c9f9b140000009fa7413ae386f1c47f7cb4dfe09750cf3d785fed&#34;</span>

<span style="color:#586e75">#Create the credential object for the Rename-Computer command</span>
<span style="color:#268bd2">$cred</span> = <span style="color:#b58900">new-object</span> -TypeName System.Management.Automation.PSCredential -ArgumentList <span style="color:#268bd2">$user</span>, (<span style="color:#268bd2">$pass</span> | <span style="color:#b58900">ConvertTo-SecureString</span>)

<span style="color:#586e75">#Go!</span>
<span style="color:#b58900">Rename-Computer</span> -newname <span style="color:#268bd2">$NewComputerName</span> -DomainCredential <span style="color:#268bd2">$cred</span>  -Restart
</code></pre></div><p>Bam; create a package in SCCM you can reference in the Task Sequence; and you&rsquo;re good to go. You can use whatever WMI queries you need in order to get your computer naming convention down; if we were deploying in multiple sites we could also use the subnet to use a site-code-prefix; however in our case we dont deploy user workstations at more than one site.</p>
		</div>

		<div class="post-tags">
			
				
					<nav class="nav tags">
							<ul class="flat">
								
								<li><a href="/tags/sccm">sccm</a></li>
								
							</ul>
					</nav>
				
			
		</div>
		</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> All Content Copyright Â© - Francis Setash   </div>
	</nav>
</div>




</body>
</html>
